{
  "openapi": "3.1.0",
  "info": {
    "title": "Exchange API",
    "description": "API for the Exchange",
    "license": {
      "name": ""
    },
    "version": "0.1.0"
  },
  "paths": {
    "/api/drip": {
      "post": {
        "tags": [
          "drip"
        ],
        "summary": "Drip tokens to users (testing/development faucet)",
        "operationId": "drip",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DripRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Tokens dripped successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DripResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DripErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid signature",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DripErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Token not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DripErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DripErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/health": {
      "get": {
        "tags": [
          "health"
        ],
        "operationId": "health_check",
        "responses": {
          "200": {
            "description": "Health check response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/info": {
      "post": {
        "tags": [
          "info"
        ],
        "summary": "Get information about tokens, markets, etc.",
        "operationId": "info",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InfoRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InfoResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InfoErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Resource not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InfoErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InfoErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/trade": {
      "post": {
        "tags": [
          "trade"
        ],
        "summary": "Execute trades (place/cancel orders)",
        "operationId": "trade",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TradeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TradeResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TradeErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid signature",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TradeErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Order not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TradeErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TradeErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/user": {
      "post": {
        "tags": [
          "user"
        ],
        "summary": "Get user-specific data (orders, balances, trades)",
        "operationId": "user",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "User or resource not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserErrorResponse"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserErrorResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ApiResponse": {
        "type": "object",
        "required": [
          "message",
          "timestamp"
        ],
        "properties": {
          "message": {
            "type": "string"
          },
          "timestamp": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          }
        }
      },
      "Balance": {
        "type": "object",
        "required": [
          "user_address",
          "token_ticker",
          "amount",
          "open_interest",
          "updated_at"
        ],
        "properties": {
          "amount": {
            "type": "integer",
            "minimum": 0
          },
          "open_interest": {
            "type": "integer",
            "minimum": 0
          },
          "token_ticker": {
            "type": "string"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "user_address": {
            "type": "string"
          }
        }
      },
      "DripErrorResponse": {
        "type": "object",
        "required": [
          "error",
          "code"
        ],
        "properties": {
          "code": {
            "type": "string"
          },
          "error": {
            "type": "string"
          }
        }
      },
      "DripRequest": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "user_address",
              "token_ticker",
              "amount",
              "signature",
              "type"
            ],
            "properties": {
              "amount": {
                "type": "string"
              },
              "signature": {
                "type": "string"
              },
              "token_ticker": {
                "type": "string"
              },
              "type": {
                "type": "string",
                "enum": [
                  "faucet"
                ]
              },
              "user_address": {
                "type": "string"
              }
            }
          }
        ],
        "description": "Drip request with type discriminator"
      },
      "DripResponse": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "user_address",
              "token_ticker",
              "amount",
              "new_balance",
              "type"
            ],
            "properties": {
              "amount": {
                "type": "string"
              },
              "new_balance": {
                "type": "string"
              },
              "token_ticker": {
                "type": "string"
              },
              "type": {
                "type": "string",
                "enum": [
                  "faucet"
                ]
              },
              "user_address": {
                "type": "string"
              }
            }
          }
        ],
        "description": "Drip response with type discriminator"
      },
      "InfoErrorResponse": {
        "type": "object",
        "required": [
          "error",
          "code"
        ],
        "properties": {
          "code": {
            "type": "string"
          },
          "error": {
            "type": "string"
          }
        }
      },
      "InfoRequest": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "ticker",
              "type"
            ],
            "properties": {
              "ticker": {
                "type": "string"
              },
              "type": {
                "type": "string",
                "enum": [
                  "token_details"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "market_id",
              "type"
            ],
            "properties": {
              "market_id": {
                "type": "string"
              },
              "type": {
                "type": "string",
                "enum": [
                  "market_details"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "all_markets"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "all_tokens"
                ]
              }
            }
          }
        ],
        "description": "Info request with type discriminator"
      },
      "InfoResponse": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "token",
              "type"
            ],
            "properties": {
              "token": {
                "$ref": "#/components/schemas/Token"
              },
              "type": {
                "type": "string",
                "enum": [
                  "token_details"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "market",
              "type"
            ],
            "properties": {
              "market": {
                "$ref": "#/components/schemas/Market"
              },
              "type": {
                "type": "string",
                "enum": [
                  "market_details"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "markets",
              "type"
            ],
            "properties": {
              "markets": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Market"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "all_markets"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "tokens",
              "type"
            ],
            "properties": {
              "tokens": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Token"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "all_tokens"
                ]
              }
            }
          }
        ],
        "description": "Info response with type discriminator"
      },
      "Market": {
        "type": "object",
        "required": [
          "id",
          "base_ticker",
          "quote_ticker",
          "tick_size",
          "lot_size",
          "min_size",
          "maker_fee_bps",
          "taker_fee_bps"
        ],
        "properties": {
          "base_ticker": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "lot_size": {
            "type": "integer",
            "minimum": 0
          },
          "maker_fee_bps": {
            "type": "integer",
            "format": "int32"
          },
          "min_size": {
            "type": "integer",
            "minimum": 0
          },
          "quote_ticker": {
            "type": "string"
          },
          "taker_fee_bps": {
            "type": "integer",
            "format": "int32"
          },
          "tick_size": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "Order": {
        "type": "object",
        "required": [
          "id",
          "user_address",
          "market_id",
          "price",
          "size",
          "side",
          "order_type",
          "status",
          "filled_size",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "filled_size": {
            "type": "integer",
            "minimum": 0
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "market_id": {
            "type": "string"
          },
          "order_type": {
            "$ref": "#/components/schemas/OrderType"
          },
          "price": {
            "type": "integer",
            "minimum": 0
          },
          "side": {
            "$ref": "#/components/schemas/Side"
          },
          "size": {
            "type": "integer",
            "minimum": 0
          },
          "status": {
            "$ref": "#/components/schemas/OrderStatus"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          },
          "user_address": {
            "type": "string"
          }
        }
      },
      "OrderStatus": {
        "type": "string",
        "enum": [
          "pending",
          "filled",
          "partially_filled",
          "cancelled"
        ]
      },
      "OrderType": {
        "type": "string",
        "enum": [
          "limit",
          "market"
        ]
      },
      "Side": {
        "type": "string",
        "enum": [
          "buy",
          "sell"
        ]
      },
      "Token": {
        "type": "object",
        "required": [
          "ticker",
          "decimals",
          "name"
        ],
        "properties": {
          "decimals": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "name": {
            "type": "string"
          },
          "ticker": {
            "type": "string"
          }
        }
      },
      "Trade": {
        "type": "object",
        "required": [
          "id",
          "market_id",
          "buyer_address",
          "seller_address",
          "buyer_order_id",
          "seller_order_id",
          "price",
          "size",
          "timestamp"
        ],
        "properties": {
          "buyer_address": {
            "type": "string"
          },
          "buyer_order_id": {
            "type": "string",
            "format": "uuid"
          },
          "id": {
            "type": "string",
            "format": "uuid"
          },
          "market_id": {
            "type": "string"
          },
          "price": {
            "type": "integer",
            "minimum": 0
          },
          "seller_address": {
            "type": "string"
          },
          "seller_order_id": {
            "type": "string",
            "format": "uuid"
          },
          "size": {
            "type": "integer",
            "minimum": 0
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "TradeErrorResponse": {
        "type": "object",
        "required": [
          "error",
          "code"
        ],
        "properties": {
          "code": {
            "type": "string"
          },
          "error": {
            "type": "string"
          }
        }
      },
      "TradeRequest": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "user_address",
              "market_id",
              "side",
              "order_type",
              "price",
              "size",
              "signature",
              "type"
            ],
            "properties": {
              "market_id": {
                "type": "string"
              },
              "order_type": {
                "$ref": "#/components/schemas/OrderType"
              },
              "price": {
                "type": "string"
              },
              "side": {
                "$ref": "#/components/schemas/Side"
              },
              "signature": {
                "type": "string"
              },
              "size": {
                "type": "string"
              },
              "type": {
                "type": "string",
                "enum": [
                  "place_order"
                ]
              },
              "user_address": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "user_address",
              "order_id",
              "signature",
              "type"
            ],
            "properties": {
              "order_id": {
                "type": "string"
              },
              "signature": {
                "type": "string"
              },
              "type": {
                "type": "string",
                "enum": [
                  "cancel_order"
                ]
              },
              "user_address": {
                "type": "string"
              }
            }
          }
        ],
        "description": "Trade request with type discriminator"
      },
      "TradeResponse": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "order",
              "trades",
              "type"
            ],
            "properties": {
              "order": {
                "$ref": "#/components/schemas/Order"
              },
              "trades": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Trade"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "place_order"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "order_id",
              "type"
            ],
            "properties": {
              "order_id": {
                "type": "string"
              },
              "type": {
                "type": "string",
                "enum": [
                  "cancel_order"
                ]
              }
            }
          }
        ],
        "description": "Trade response with type discriminator"
      },
      "UserErrorResponse": {
        "type": "object",
        "required": [
          "error",
          "code"
        ],
        "properties": {
          "code": {
            "type": "string"
          },
          "error": {
            "type": "string"
          }
        }
      },
      "UserRequest": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "user_address",
              "type"
            ],
            "properties": {
              "limit": {
                "type": [
                  "integer",
                  "null"
                ],
                "format": "int32",
                "minimum": 0
              },
              "market_id": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "status": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "type": {
                "type": "string",
                "enum": [
                  "orders"
                ]
              },
              "user_address": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "user_address",
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "balances"
                ]
              },
              "user_address": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "user_address",
              "type"
            ],
            "properties": {
              "limit": {
                "type": [
                  "integer",
                  "null"
                ],
                "format": "int32",
                "minimum": 0
              },
              "market_id": {
                "type": [
                  "string",
                  "null"
                ]
              },
              "type": {
                "type": "string",
                "enum": [
                  "trades"
                ]
              },
              "user_address": {
                "type": "string"
              }
            }
          }
        ],
        "description": "User request with type discriminator"
      },
      "UserResponse": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "orders",
              "type"
            ],
            "properties": {
              "orders": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Order"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "orders"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "balances",
              "type"
            ],
            "properties": {
              "balances": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Balance"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "balances"
                ]
              }
            }
          },
          {
            "type": "object",
            "required": [
              "trades",
              "type"
            ],
            "properties": {
              "trades": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Trade"
                }
              },
              "type": {
                "type": "string",
                "enum": [
                  "trades"
                ]
              }
            }
          }
        ],
        "description": "User response with type discriminator"
      }
    }
  },
  "tags": [
    {
      "name": "api",
      "description": "General API endpoints"
    },
    {
      "name": "info",
      "description": "Information endpoints"
    },
    {
      "name": "user",
      "description": "User data endpoints"
    },
    {
      "name": "trade",
      "description": "Trading endpoints"
    },
    {
      "name": "drip",
      "description": "Get free money"
    }
  ]
}